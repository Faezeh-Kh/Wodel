/**
 * generated by Xtext
 */
package org.mutatorgraph.validation;

import exceptions.MetaModelNotFoundException;
import java.util.ArrayList;
import manager.ModelManager;
import mutatorgraph.MutatorGraph;
import org.eclipse.emf.ecore.EPackage;
import org.eclipse.xtext.validation.Check;
import org.eclipse.xtext.xbase.lib.Exceptions;
import org.mutatorgraph.validation.AbstractMutatorGraphValidator;

/**
 * This class contains custom validation rules.
 * 
 * See https://www.eclipse.org/Xtext/documentation/303_runtime_concepts.html#validation
 */
@SuppressWarnings("all")
public class MutatorGraphValidator extends AbstractMutatorGraphValidator {
  public final static String INVALID_METAMODEL = "invalidMetamodel";
  
  private ArrayList<EPackage> packages;
  
  private String lastMetamodel = "";
  
  @Check
  public ArrayList<EPackage> checkMutatorGraphMetaModel(final MutatorGraph mutatorgraph) {
    ArrayList<EPackage> _xblockexpression = null;
    {
      String path = mutatorgraph.getMetamodel();
      ArrayList<EPackage> _xtrycatchfinallyexpression = null;
      try {
        ArrayList<EPackage> _xifexpression = null;
        boolean _equals = this.lastMetamodel.equals(path);
        boolean _not = (!_equals);
        if (_not) {
          ArrayList<EPackage> _xblockexpression_1 = null;
          {
            this.lastMetamodel = path;
            ArrayList<EPackage> _loadMetaModel = ModelManager.loadMetaModel(path);
            _xblockexpression_1 = this.packages = _loadMetaModel;
          }
          _xifexpression = _xblockexpression_1;
        }
        _xtrycatchfinallyexpression = _xifexpression;
      } catch (final Throwable _t) {
        if (_t instanceof MetaModelNotFoundException) {
          final MetaModelNotFoundException e = (MetaModelNotFoundException)_t;
          String _string = e.toString();
          this.error(_string, null, MutatorGraphValidator.INVALID_METAMODEL);
        } else {
          throw Exceptions.sneakyThrow(_t);
        }
      }
      _xblockexpression = _xtrycatchfinallyexpression;
    }
    return _xblockexpression;
  }
}
